# Practice-MongoDB

> MongoDB Schema 설계

# Schema란?

> MongoDB에서 Schema는 데이터베이스에서 사용되는 문서의 구조를 정의하는 것
> Schema는 필드 이름, 타입, 기본값, 제약 조건 등을 정의하여 문서의 형식을 결정
> MongoDB는 Schemaless이므로, 각 문서는 자유롭게 필드를 추가하거나 제거할 수 있다.
> 각 문서의 구조를 일정하게 유지하고자 하는 경우에는 스키마를 사용할 수 있음

# 데이터의 관계 타입

> 데이터베이스에서 테이블간의 관계를 정의하는 것

## One-to-One 관계

- 한 문서에서 다른 한 문서와 1:1 관계를 가지는 경우이다.
- 예를 들어, 한 사용자에 대한 개인 정보 문서와 한 사용자가 소유한 계좌 정보 문서는 각각 다른 문서이지만 각각 한 사용자에 대한 것이다.

## One-to-Many 관계

- 한 문서에서 다른 다수의 문서와 1:N 관계를 가지는 경우이다.
- 예를 들어, 한 저자에 대한 정보 문서와 그 저자가 작성한 다수의 책 문서는 각각 다른 문서이지만 각각 한 저자에 대한 것이다.

## Many-to-Many 관계

- 두 개의 문서가 서로 다수의 문서와 N:M 관계를 가지는 경우이다.
- 예를 들어, 다수의 학생 문서와 다수의 강의 문서가 있을 때, 각 학생은 다수의 강의를 수강할 수 있으며, 각 강의는 다수의 학생이 수강할 수 있다.

# 데이터의 관계 타입을 구현하는 방법

> 데이터베이스에서 데이터 간의 연결 관계를 정의하고 구현하는 것을 말한다.
> 데이터의 정제와 정규화, 효율적인 데이터 관리를 위해 필요하다.

## Embedded

- 관련된 데이터를 하나의 문서에 임베디드 하는 방식
- Embedded는 관련된 데이터를 하나의 문서에 내장하여 저장하는 방식을 의미한다.
- 이를 통해 관련된 데이터를 한 번에 처리할 수 있고, 저장 공간을 절약할 수 있다.

## Referenced

- 관련된 데이터를 다른 문서에 참조하는 방식
- 다른 문서와의 관계를 표현할 수 있으며, 관련 문서에 대한 정보를 가지고 있는 문서를 참조할 수 있다.

# MongoDB Schema Design의 기본 룰

## "Embed where you can, Reference where you must"

- 가능한 경우에는 하위 문서를 임베딩하여 쿼리시 모든 데이터를 한번에 조회할 수 있도록 하고,
  데이터 규모가 커지거나 데이터 업데이트시 성능에 영향이 있을 경우 참조를 사용하는 것이 좋다.

## "Keep related data together"

- 관련된 데이터는 함께 저장하며, 쿼리시 빠르게 데이터를 조회할 수 있도록 한다.

## "Denormalize selectively"

- 선택적으로 데이터를 비정규화할 수 있다.
- 비정규화를 통해 쿼리시 데이터를 빠르게 조회하지만, 업데이트 시 데이터 정합성 문제가 발생할 수 있으므로 신중하게 사용해야한다.

## "Design for the queries you need"

- 사용할 쿼리에 따라 스키마를 설계하여, 쿼리 실행 속도를 향상시킬 수 있도록 한다.

## Keep it simple"

- 스키마 설계에서 가장 간단한 구조로 설계하는 것이 좋은 것을 의미(가능한 최소한의 엔티티로 데이터를 구조화하는 것이 좋다).
- 이는 유지보수와 확장성을 향상시키며, 코드의 가독성과 유지보수가 향상되기 때문이다.
